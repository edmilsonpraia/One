<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão Comercial - Copia Group of Companies, SA</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/style-adicional.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="Picture1.png" alt="Copia Group of Companies Logo" class="logo-image">
                <h1>Sistema de Gestão Comercial</h1>
            </div>
            <div class="nav-actions">
                <button class="btn btn-primary" id="add-button">
                    <i class="fas fa-plus"></i> Novo
                </button>
                <button class="btn btn-success" onclick="exportAllToExcel()">
                    <i class="fas fa-file-excel"></i> Exportar
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('dashboard')">
                <i class="fas fa-th-large"></i> Dashboard
            </button>
            <button class="tab-btn" onclick="showTab('fornecedores')">
                <i class="fas fa-building"></i> Fornecedores
            </button>
            <button class="tab-btn" onclick="showTab('prestadores')">
                <i class="fas fa-user-tie"></i> Prestadores
            </button>
            <button class="tab-btn" onclick="showTab('contratos')">
                <i class="fas fa-file-contract"></i> Contratos
            </button>
            <button class="tab-btn" onclick="showTab('memorandos')">
                <i class="fas fa-file-alt"></i> Memorandos
            </button>
            <button class="tab-btn" onclick="showTab('parcerias')">
                <i class="fas fa-handshake"></i> Parcerias
            </button>
            <button class="tab-btn" onclick="showTab('contabilidade')">
                <i class="fas fa-chart-line"></i> Contabilidade
            </button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard-tab" class="tab-content active">
            <!-- Stats Grid -->
            <div class="stats-grid-extended">
                <div class="stat-card" onclick="showTab('fornecedores')">
                    <div class="stat-icon blue">
                        <i class="fas fa-building"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-fornecedores">0</h3>
                        <p>Fornecedores</p>
                    </div>
                </div>
                <div class="stat-card" onclick="showTab('prestadores')">
                    <div class="stat-icon green">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-prestadores">0</h3>
                        <p>Prestadores</p>
                    </div>
                </div>
                <div class="stat-card" onclick="showTab('contratos')">
                    <div class="stat-icon orange">
                        <i class="fas fa-file-contract"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-contratos">0</h3>
                        <p>Contratos</p>
                    </div>
                </div>
                <div class="stat-card" onclick="showTab('memorandos')">
                    <div class="stat-icon purple">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-memorandos">0</h3>
                        <p>Memorandos</p>
                    </div>
                </div>
                <div class="stat-card" onclick="showTab('parcerias')">
                    <div class="stat-icon brown">
                        <i class="fas fa-handshake"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-parcerias">0</h3>
                        <p>Parcerias</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon teal">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-geral">0</h3>
                        <p>Total Geral</p>
                    </div>
                </div>
            </div>

            <!-- Charts -->
            <div class="charts-grid">
                <div class="chart-card">
                    <h3><i class="fas fa-chart-pie"></i> Distribuição por Categoria</h3>
                    <canvas id="categoryChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3><i class="fas fa-chart-bar"></i> Fornecedores por Área</h3>
                    <canvas id="areaChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3><i class="fas fa-chart-line"></i> Status Geral</h3>
                    <canvas id="statusChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Fornecedores Tab -->
        <div id="fornecedores-tab" class="tab-content">
            <div class="module-header">
                <h2><i class="fas fa-building"></i> Gestão de Fornecedores</h2>
                <button class="btn btn-primary" onclick="openModal('fornecedor')">
                    <i class="fas fa-plus"></i> Novo Fornecedor
                </button>
            </div>
            <div class="filters-section">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-fornecedores" placeholder="Pesquisar fornecedor...">
                </div>
                <div class="filter-group">
                    <select id="filter-fornecedor-status">
                        <option value="">Todos os Status</option>
                        <option value="corrente">Corrente</option>
                        <option value="não corrente">Não Corrente</option>
                    </select>
                    <select id="filter-fornecedor-area">
                        <option value="">Todas as Áreas</option>
                    </select>
                </div>
            </div>
            <div class="table-container">
                <table id="fornecedores-table">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Nome</th>
                            <th>Status</th>
                            <th>Área</th>
                            <th>Produto/Serviço</th>
                            <th>Valor</th>
                            <th>Avaliação</th>
                            <th>Responsável</th>
                            <th class="actions-col">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="fornecedores-tbody"></tbody>
                </table>
            </div>
            <div class="pagination" id="pagination-fornecedores"></div>
        </div>

        <!-- Prestadores Tab -->
        <div id="prestadores-tab" class="tab-content">
            <div class="module-header">
                <h2><i class="fas fa-user-tie"></i> Prestadores de Serviços</h2>
                <button class="btn btn-primary" onclick="openModal('prestador')">
                    <i class="fas fa-plus"></i> Novo Prestador
                </button>
            </div>
            <div class="filters-section">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-prestadores" placeholder="Pesquisar prestador...">
                </div>
            </div>
            <div class="table-container">
                <table id="prestadores-table">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Nome/Empresa</th>
                            <th>Tipo de Serviço</th>
                            <th>Área</th>
                            <th>Periodicidade</th>
                            <th>Status</th>
                            <th class="actions-col">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="prestadores-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- Contratos Tab -->
        <div id="contratos-tab" class="tab-content">
            <div class="module-header">
                <h2><i class="fas fa-file-contract"></i> Contratos</h2>
                <button class="btn btn-primary" onclick="openModal('contrato')">
                    <i class="fas fa-plus"></i> Novo Contrato
                </button>
            </div>
            <div class="filters-section">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-contratos" placeholder="Pesquisar contrato...">
                </div>
            </div>
            <div class="table-container">
                <table id="contratos-table">
                    <thead>
                        <tr>
                            <th>Código</th>
                            <th>Tipo</th>
                            <th>Entidade</th>
                            <th>Objeto</th>
                            <th>Data Contrato</th>
                            <th>Importância</th>
                            <th>Avaliação</th>
                            <th>Status</th>
                            <th class="actions-col">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="contratos-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- Memorandos Tab -->
        <div id="memorandos-tab" class="tab-content">
            <div class="module-header">
                <h2><i class="fas fa-file-alt"></i> Memorandos</h2>
                <div style="display: flex; gap: 0.5rem;">
                    <button class="btn btn-success" onclick="exportarMemorandos()">
                        <i class="fas fa-file-excel"></i> Exportar Excel
                    </button>
                    <button class="btn btn-primary" onclick="openModal('memorando')">
                        <i class="fas fa-plus"></i> Novo Memorando
                    </button>
                </div>
            </div>
            <div class="filters-section">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-memorandos" placeholder="Pesquisar memorando...">
                </div>
            </div>
            <div class="table-container">
                <table id="memorandos-table">
                    <thead>
                        <tr>
                            <th>Nº</th>
                            <th>Empresa</th>
                            <th>Data</th>
                            <th>Área Origem</th>
                            <th>Destinatário</th>
                            <th>Tipo</th>
                            <th>Objeto</th>
                            <th>Duração</th>
                            <th>Descrição</th>
                            <th>Documento</th>
                            <th>Responsável</th>
                            <th class="actions-col">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="memorandos-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- Parcerias Tab -->
        <div id="parcerias-tab" class="tab-content">
            <div class="module-header">
                <h2><i class="fas fa-handshake"></i> Parcerias e Associações</h2>
                <button class="btn btn-primary" onclick="openModal('parceria')">
                    <i class="fas fa-plus"></i> Nova Parceria
                </button>
            </div>
            <div class="filters-section">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-parcerias" placeholder="Pesquisar parceria...">
                </div>
            </div>
            <div class="table-container">
                <table id="parcerias-table">
                    <thead>
                        <tr>
                            <th>Entidade</th>
                            <th>Tipo</th>
                            <th>Área Atuação</th>
                            <th>Tipo Parceria</th>
                            <th>Periodicidade</th>
                            <th>Status</th>
                            <th class="actions-col">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="parcerias-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- Contabilidade Tab -->
        <div id="contabilidade-tab" class="tab-content">
            <div class="module-header">
                <h2><i class="fas fa-chart-line"></i> Análise Contabilística e Financeira</h2>
                <button class="btn btn-success" onclick="exportarRelatorioFinanceiro()">
                    <i class="fas fa-file-excel"></i> Exportar Relatório
                </button>
            </div>

            <!-- Financial Summary Cards -->
            <div class="stats-grid-extended">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-receitas">Kz 0,00</h3>
                        <p>Total Receitas Estimadas</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                        <i class="fas fa-hand-holding-usd"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-despesas">Kz 0,00</h3>
                        <p>Total Despesas/Fornecedores</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="saldo-liquido">Kz 0,00</h3>
                        <p>Saldo Líquido</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="total-dividas">Kz 0,00</h3>
                        <p>Total em Dívida</p>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0;">
                <div class="chart-container" style="background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin: 0 0 1rem 0; color: #A0682A;">Despesas por Departamento</h3>
                    <canvas id="despesas-departamento-chart"></canvas>
                </div>
                <div class="chart-container" style="background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin: 0 0 1rem 0; color: #A0682A;">Receitas vs Despesas (Mensal)</h3>
                    <canvas id="receitas-despesas-chart"></canvas>
                </div>
            </div>

            <!-- Departamentos Financial Table -->
            <div style="background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin: 2rem 0;">
                <h3 style="margin: 0 0 1rem 0; color: #A0682A; border-bottom: 2px solid #E07B39; padding-bottom: 0.5rem;">
                    <i class="fas fa-building"></i> Análise Financeira por Departamento/Área
                </h3>
                <div class="table-container">
                    <table id="departamentos-financeiro-table">
                        <thead>
                            <tr>
                                <th>Departamento/Área</th>
                                <th>Nº Fornecedores</th>
                                <th>Nº Prestadores</th>
                                <th>Nº Contratos</th>
                                <th>Total Despesas</th>
                                <th>Total Pago</th>
                                <th>Total em Dívida</th>
                                <th>% do Total</th>
                            </tr>
                        </thead>
                        <tbody id="departamentos-financeiro-tbody"></tbody>
                        <tfoot>
                            <tr style="background: #f8f4ef; font-weight: bold; font-size: 1.1em;">
                                <td>TOTAL GERAL</td>
                                <td id="total-fornecedores-geral">0</td>
                                <td id="total-prestadores-geral">0</td>
                                <td id="total-contratos-geral">0</td>
                                <td id="total-despesas-geral">Kz 0,00</td>
                                <td id="total-pago-geral">Kz 0,00</td>
                                <td id="total-divida-geral">Kz 0,00</td>
                                <td>100%</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

            <!-- Fornecedores com Maior Despesa -->
            <div style="background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h3 style="margin: 0 0 1rem 0; color: #A0682A; border-bottom: 2px solid #E07B39; padding-bottom: 0.5rem;">
                    <i class="fas fa-trophy"></i> Top 10 Fornecedores por Despesa
                </h3>
                <div class="table-container">
                    <table id="top-fornecedores-table">
                        <thead>
                            <tr>
                                <th>Posição</th>
                                <th>Código</th>
                                <th>Nome</th>
                                <th>Departamento</th>
                                <th>Produto/Serviço</th>
                                <th>Valor</th>
                                <th>Frequência</th>
                                <th>Avaliação</th>
                            </tr>
                        </thead>
                        <tbody id="top-fornecedores-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Universal Modal -->
    <div id="universal-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Modal</h2>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div id="modal-body"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="js/data-manager.js"></script>
    <script src="js/forms.js"></script>
    <script src="js/charts-novo.js"></script>
    <script src="js/export-novo.js"></script>
    <script src="js/fatura.js"></script>
    <script src="js/contabilidade.js"></script>
    <script src="js/app-novo.js"></script>
</body>
</html>
